select * from product_childrens where in_set = 0;
+----+------------+-------------+------------+-------------+--------+
| id | product_id | children_id | by_default | necessarily | in_set |
+----+------------+-------------+------------+-------------+--------+
|  1 |         14 |          15 |          1 |           1 |      0 |
|  2 |         14 |          16 |          1 |           0 |      0 |
|  3 |         14 |          17 |          1 |           0 |      0 |
|  4 |         14 |          18 |          0 |           0 |      0 |
+----+------------+-------------+------------+-------------+--------+

select * from spree_variants where product_id in (15,16,17,18);
+-----+-----+--------+--------+-------+-------+------------+----------------+-----------+------------+------------+---------------+----------+-----------------+-----------------+---------------------+---------------------+------------+
| id  | sku | weight | height | width | depth | deleted_at | discontinue_on | is_master | product_id | cost_price | cost_currency | position | track_inventory | tax_category_id | updated_at          | created_at          | sale_price |
+-----+-----+--------+--------+-------+-------+------------+----------------+-----------+------------+------------+---------------+----------+-----------------+-----------------+---------------------+---------------------+------------+
| 211 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         1 |         15 |       NULL | MDL           |        1 |               1 |            NULL | 2018-01-19 18:07:26 | 2018-01-18 12:06:38 |       NULL |
| 216 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         15 |       NULL | MDL           |        2 |               1 |            NULL | 2018-01-20 11:07:00 | 2018-01-20 11:07:00 |       NULL |
| 217 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         15 |       NULL | MDL           |        3 |               1 |            NULL | 2018-01-20 11:07:45 | 2018-01-20 11:07:45 |       NULL |
| 218 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         15 |       NULL | MDL           |        4 |               1 |            NULL | 2018-01-20 11:08:26 | 2018-01-20 11:08:26 |       NULL |
| 219 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         15 |       NULL | MDL           |        5 |               1 |            NULL | 2018-01-20 11:08:38 | 2018-01-20 11:08:38 |       NULL |
| 220 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         15 |       NULL | MDL           |        6 |               1 |            NULL | 2018-01-20 11:11:08 | 2018-01-20 11:11:08 |       NULL |
| 212 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         1 |         16 |       NULL | MDL           |        1 |               1 |            NULL | 2018-01-19 18:08:19 | 2018-01-19 18:08:05 |       NULL |
| 221 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         16 |       NULL | MDL           |        2 |               1 |            NULL | 2018-01-20 11:12:56 | 2018-01-20 11:12:56 |       NULL |
| 222 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         16 |       NULL | MDL           |        3 |               1 |            NULL | 2018-01-20 11:13:03 | 2018-01-20 11:13:03 |       NULL |
| 223 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         16 |       NULL | MDL           |        4 |               1 |            NULL | 2018-01-20 11:13:10 | 2018-01-20 11:13:10 |       NULL |
| 224 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         16 |       NULL | MDL           |        5 |               1 |            NULL | 2018-01-20 11:13:25 | 2018-01-20 11:13:25 |       NULL |
| 225 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         16 |       NULL | MDL           |        6 |               1 |            NULL | 2018-01-20 11:13:39 | 2018-01-20 11:13:39 |       NULL |
| 213 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         1 |         17 |       NULL | MDL           |        1 |               1 |            NULL | 2018-01-19 18:09:36 | 2018-01-19 18:09:26 |       NULL |
| 226 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         17 |       NULL | MDL           |        2 |               1 |            NULL | 2018-01-20 11:14:43 | 2018-01-20 11:14:43 |       NULL |
| 227 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         17 |       NULL | MDL           |        3 |               1 |            NULL | 2018-01-20 11:14:53 | 2018-01-20 11:14:53 |       NULL |
| 228 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         17 |       NULL | MDL           |        4 |               1 |            NULL | 2018-01-20 11:15:02 | 2018-01-20 11:15:02 |       NULL |
| 229 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         17 |       NULL | MDL           |        5 |               1 |            NULL | 2018-01-20 11:15:17 | 2018-01-20 11:15:17 |       NULL |
| 230 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         17 |       NULL | MDL           |        6 |               1 |            NULL | 2018-01-20 11:15:29 | 2018-01-20 11:15:29 |       NULL |
| 214 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         1 |         18 |       NULL | MDL           |        1 |               1 |            NULL | 2018-01-19 18:09:59 | 2018-01-19 18:09:52 |       NULL |
| 231 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         18 |       NULL | MDL           |        2 |               1 |            NULL | 2018-01-20 11:16:35 | 2018-01-20 11:16:35 |       NULL |
| 232 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         18 |       NULL | MDL           |        3 |               1 |            NULL | 2018-01-20 11:16:44 | 2018-01-20 11:16:44 |       NULL |
| 233 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         18 |       NULL | MDL           |        4 |               1 |            NULL | 2018-01-20 11:16:53 | 2018-01-20 11:16:53 |       NULL |
| 234 |     |   0.00 |   NULL |  NULL |  NULL | NULL       | NULL           |         0 |         18 |       NULL | MDL           |        5 |               1 |            NULL | 2018-01-20 11:17:00 | 2018-01-20 11:17:00 |       NULL |
+-----+-----+--------+--------+-------+-------+------------+----------------+-----------+------------+------------+---------------+----------+-----------------+-----------------+---------------------+---------------------+------------+

select GROUP_CONCAT(id SEPARATOR ',') AS result from spree_variants where product_id in (15,16,17,18);
+---------------------------------------------------------------------------------------------+
| result                                                                                      |
+---------------------------------------------------------------------------------------------+
| 211,216,217,218,219,220,212,221,222,223,224,225,213,226,227,228,229,230,214,231,232,233,234 |
+---------------------------------------------------------------------------------------------+

select * from spree_option_value_variants WHERE option_value_id = 9 AND variant_id IN (211,216,217,218,219,220,212,221,222,223,224,225,213,226,227,228,229,230,214,231,232,233,234);
+------------+-----------------+-----+
| variant_id | option_value_id | id  |
+------------+-----------------+-----+
|        216 |               9 | 591 |
|        217 |               9 | 594 |
|        218 |               9 | 597 |
|        219 |               9 | 600 |
|        221 |               9 | 608 |
|        222 |               9 | 611 |
|        223 |               9 | 617 |
|        224 |               9 | 616 |
|        226 |               9 | 623 |
|        227 |               9 | 626 |
|        228 |               9 | 629 |
|        229 |               9 | 632 |
|        231 |               9 | 638 |
|        232 |               9 | 641 |
|        233 |               9 | 644 |
|        234 |               9 | 647 |
+------------+-----------------+-----+

select GROUP_CONCAT(variant_id SEPARATOR ',') AS result from spree_option_value_variants WHERE option_value_id = 9 AND variant_id IN (211,216,217,218,219,220,212,221,222,223,224,225,213,226,227,228,229,230,214,231,232,233,234);
+-----------------------------------------------------------------+
| result                                                          |
+-----------------------------------------------------------------+
| 216,217,218,219,221,222,223,224,226,227,228,229,231,232,233,234 |
+-----------------------------------------------------------------+

select * from spree_option_value_variants WHERE variant_id IN (216,217,218,219,221,222,223,224,226,227,228,229,231,232,233,234);
+------------+-----------------+-----+
| variant_id | option_value_id | id  |
+------------+-----------------+-----+
|        216 |               1 | 593 |
|        216 |               9 | 591 |
|        216 |              14 | 592 |
|        217 |               1 | 596 |
|        217 |               9 | 594 |
|        217 |              10 | 595 |
|        218 |               9 | 597 |
|        218 |              14 | 598 |
|        218 |              20 | 599 |
|        219 |               9 | 600 |
|        219 |              10 | 601 |
|        219 |              20 | 602 |
|        221 |               1 | 606 |
|        221 |               9 | 608 |
|        221 |              10 | 607 |
|        222 |               1 | 609 |
|        222 |               9 | 611 |
|        222 |              14 | 610 |
|        223 |               9 | 617 |
|        223 |              10 | 613 |
|        223 |              20 | 612 |
|        224 |               9 | 616 |
|        224 |              14 | 615 |
|        224 |              20 | 614 |
|        226 |               1 | 621 |
|        226 |               9 | 623 |
|        226 |              10 | 622 |
|        227 |               1 | 624 |
|        227 |               9 | 626 |
|        227 |              14 | 625 |
|        228 |               9 | 629 |
|        228 |              10 | 628 |
|        228 |              20 | 627 |
|        229 |               9 | 632 |
|        229 |              14 | 631 |
|        229 |              20 | 630 |
|        231 |               1 | 636 |
|        231 |               9 | 638 |
|        231 |              10 | 637 |
|        232 |               1 | 639 |
|        232 |               9 | 641 |
|        232 |              14 | 640 |
|        233 |               9 | 644 |
|        233 |              10 | 643 |
|        233 |              20 | 642 |
|        234 |               9 | 647 |
|        234 |              14 | 646 |
|        234 |              20 | 645 |
+------------+-----------------+-----+

select GROUP_CONCAT(DISTINCT(option_value_id) SEPARATOR ',') AS result from spree_option_value_variants WHERE variant_id IN (216,217,218,219,221,222,223,224,226,227,228,229,231,232,233,234);
+--------------+
| result       |
+--------------+
| 1,9,10,14,20 |
+--------------+
